---
layout: post
title: AlmaLinux 9.1ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆNextcloudç·¨ï¼‰
tags: Tech è‡ªå®…é¯–
---

## æ§‹æƒ³

[è‡ªå®…é¯– æ§‹æƒ³ 2023](../../../2023/04/15/01.html)

## é–¢é€£è¨˜äº‹

1. [è‡ªå®…é¯– æ§‹æˆãƒ¡ãƒ¢ 2023](../../../2023/04/12/01.html)
2. [AlmaLinux 9.1 ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆKVM ãƒ›ã‚¹ãƒˆç·¨ï¼‰](../../../2023/04/15/02.html)
3. [AlmaLinux 9.1 ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆVM ã‚²ã‚¹ãƒˆç·¨ï¼‰](../../../2023/04/16/01.html)
4. [AlmaLinux 9.1 ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆNextcloud ç·¨ï¼‰](../../../2023/07/04/01.html) â† ã‚¤ãƒã‚³ã‚³
5. [AlmaLinux 9.1 ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆJoplin ç·¨ï¼‰](../../../2023/07/07/01.html)
6. AlmaLinux 9.1 ã§è‡ªåˆ†ç”¨ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆå¤–éƒ¨å…¬é–‹ç·¨ï¼‰

## Nextcloud ã¨ã¯ï¼Ÿ

`Nextcloud`ã¨ã¯ OSS ãªã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã€‚  
Dropbox ã‚„ OneDrive ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ã€ãŠã†ã¡ã«æ§‹ç¯‰ã§ãã‚‹ã€‚  
[å‚è€ƒ](https://nextcloud.stylez.co.jp/)ã€‚

## ã‚„ã£ãŸã“ã¨

### 1. Nextcloud ãŒå‹•ä½œã™ã‚‹ãŸã‚ã®ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶ï¼†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã‚’ç¢ºèªã™ã‚‹

- [ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶](https://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.html)
- [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †](https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html)

### 2. Nextcloud ã®å‹•ä½œã•ã›ã‚‹ãŸã‚ã«å¿…è¦ãªã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

å¿…è¦ãªã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã€‚  
å…·ä½“çš„ã«ã¯

- nginx
- PHP 8.1 ã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¾¤
- MySQL 8.0+
- FFmpeg

#### nginx

**â€» [å¾Œè¿°ã™ã‚‹å•é¡Œ](../../../2023/07/04/01.html#office-ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–²è¦§ã§ããªã„) ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ãŠã¨ãªã—ã Apache HTTP Server ã§æ§‹ç¯‰ã™ã‚‹ã®ãŒç„¡é›£ã€‚**

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```shell
dnf install nginx
```

`nginx -v`ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã€‚å•é¡Œãªã—ã€‚

```shell
nginx version: nginx/1.20.1
```

#### PHP 8.1 ã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¾¤

ãªã«ã‚‚ã—ãªã„ã¨å‚ç…§ã—ã¦ã„ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã®éƒ½åˆä¸Š PHP8.0 ã—ã‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„ã€‚  
ä»Šå›ã¯ PHP8.1 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ã®ã§ã€PHP8.1 ã® remi ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚

```shell
dnf install https://rpms.remirepo.net/enterprise/remi-release-$(rpm -E %rhel).rpm
dnf config-manager --set-enabled remi
```

PHP ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```shell
dnf module reset php
dnf module install php:remi-8.1
```

remi ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ PHP8.1 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```shell
=======================================================================================================================================================
 Package                               Architecture                Version                                     Repository                         Size
=======================================================================================================================================================
Installing group/module packages:
 php-cli                               x86_64                      8.1.20-1.el9.remi                           remi-modular                      5.2 M
 php-common                            x86_64                      8.1.20-1.el9.remi                           remi-modular                      832 k
 php-fpm                               x86_64                      8.1.20-1.el9.remi                           remi-modular                      1.8 M
 php-mbstring                          x86_64                      8.1.20-1.el9.remi                           remi-modular                      521 k
 php-xml                               x86_64                      8.1.20-1.el9.remi                           remi-modular                      203 k
Installing dependencies:
 httpd-filesystem                      noarch                      2.4.53-11.el9_2.5                           appstream                          14 k
 libxslt                               x86_64                      1.1.34-9.el9                                appstream                         240 k
 oniguruma5php                         x86_64                      6.9.8-1.el9.remi                            remi                              219 k
Installing weak dependencies:
 nginx-filesystem                      noarch                      1:1.20.1-14.el9.alma                        appstream                          11 k
Installing module profiles:
 php/common
Enabling module streams:
 php                                                               remi-8.1

Transaction Summary
=======================================================================================================================================================
Install  9 Packages

Total download size: 9.0 M
Installed size: 53 M
Is this ok [y/N]:
```

`php -v`ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã€‚å•é¡Œãªã—ã€‚

```shell
PHP 8.1.20 (cli) (built: Jun  6 2023 23:02:31) (NTS gcc x86_64)
Copyright (c) The PHP Group
Zend Engine v4.1.20, Copyright (c) Zend Technologies
```

ç¾åœ¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ PHP ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯`php -m`ã§ç¢ºèªã§ãã‚‹ã€‚

```shell
[PHP Modules]
bz2
calendar
Core
ctype
curl
date
dom
exif
fileinfo
filter
ftp
gettext
hash
iconv
json
libxml
mbstring
openssl
pcntl
pcre
Phar
readline
Reflection
session
SimpleXML
sockets
SPL
standard
tokenizer
xml
xmlreader
xmlwriter
xsl
zlib

[Zend Modules]
```

ç¾åœ¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æƒ…å ±ã‚’å‚è€ƒã«ã€è¶³ã‚Šãªã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã€‚  
å€‹äººçš„ã«ã¯ã€å¤–éƒ¨èªè¨¼ã®äºˆå®šãŒãªã„ã“ã¨ã¨ã€å€‹äººåˆ©ç”¨ãªã®ã§ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å¼·åŒ–ã‚‚ä¸è¦ã‹ãªã¨ã„ã†ã“ã¨ã§ã€[ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶](https://docs.nextcloud.com/server/latest/admin_manual/installation/system_requirements.html)ã®

- `Required for specific apps`
- `For enhanced server performance (optional) select one of the following memcaches`

ã«æ›¸ã„ã¦ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªã‹ã£ãŸã€‚  
ãã‚Œä»¥å¤–ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```shell
dnf install php-gd php-posix php-zip php-mysqlnd php-intl php-imagick
```

```shell
=======================================================================================================================================================
 Package                                           Architecture        Version                                         Repository                 Size
=======================================================================================================================================================
Installing:
 php-gd                                            x86_64              8.1.20-1.el9.remi                               remi-modular               62 k
 php-intl                                          x86_64              8.1.20-1.el9.remi                               remi-modular              209 k
 php-mysqlnd                                       x86_64              8.1.20-1.el9.remi                               remi-modular              214 k
 php-pecl-imagick-im7                              x86_64              3.7.0-7.el9.remi.8.1                            remi-modular              187 k
 php-pecl-zip                                      x86_64              1.22.1-1.el9.remi.8.1                           remi-modular               74 k
 php-process                                       x86_64              8.1.20-1.el9.remi                               remi-modular               64 k
 ...
```

`php -m`ã§å†ç¢ºèªã€‚å•é¡Œãªã—ã€‚

```shell
[PHP Modules]
bz2
calendar
Core
ctype
curl
date
dom
exif
fileinfo
filter
ftp
gd
gettext
hash
iconv
imagick
intl
json
libxml
mbstring
mysqli
mysqlnd
openssl
pcntl
pcre
PDO
pdo_mysql
pdo_sqlite
Phar
posix
readline
Reflection
session
shmop
SimpleXML
sockets
SPL
sqlite3
standard
sysvmsg
sysvsem
sysvshm
tokenizer
xml
xmlreader
xmlwriter
xsl
zip
zlib

[Zend Modules]
```

**â€» è£œè¶³**

`php-posix`ã¯`php-process`ã«å«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

**â€» ä½™è«‡**

ã¡ãªã¿ã« Almalinux 9.1 ã§`rpm -E %rhel`ã‚’å®Ÿè¡Œã™ã‚‹ã¨`9`ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã€‚  
OS ã®ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã£ã¦ã‚‚ã‚³ãƒ”ãƒšã§å¯¾å¿œã§ãã‚‹ã­ã€‚  
æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: RPM ãƒã‚¯ãƒ­

#### MySQL 8.0+

MySQL ã® 8.0 ã‚ˆã‚Šé«˜ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚  
æ™®é€šã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚Œã° OKã€‚

```shell
dnf install mysql mysql-server
```

`mysql --version`ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã€‚å•é¡Œãªã—ã€‚

```shell
mysql  Ver 8.0.32 for Linux on x86_64 (Source distribution)
```

#### FFmpeg

ãŠãã‚‰ã Nextcloud ï¼ˆWebï¼‰ä¸Šã§éŸ³å£°ã‚„å‹•ç”»ã‚’è¡¨ç¤ºã™ã‚‹éš›ã«ä½¿ã†ã¯ãšã€‚

ã¾ãš EPEL ãƒªãƒã‚¸ãƒˆãƒªã¨ PowerTools(CRB) ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚

```shell
dnf install epel-release
dnf config-manager --set-enabled crb
```

æ¬¡ã« RPM Fusion ãƒªãƒã‚¸ãƒˆãƒªã‚’è¿½åŠ ã™ã‚‹ã€‚

```shell
dnf install --nogpgcheck https://mirrors.rpmfusion.org/free/el/rpmfusion-free-release-$(rpm -E %rhel).noarch.rpm
```

FFmpeg ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```shell
dnf install ffmpeg
```

`ffmpeg -version`ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªã€‚å•é¡Œãªã—ã€‚

```shell
ffmpeg version 5.1.3 Copyright (c) 2000-2022 the FFmpeg developers
...
```

## 3. ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹å§‹ï¼†è‡ªå‹•èµ·å‹•è¨­å®šã‚’è¡Œã†

### nginx

```shell
systemctl start nginx.service
systemctl enable nginx.service
```

### php-fpm

```shell
systemctl start php-fpm.service
systemctl enable php-fpm.service
```

### MySQL

```shell
systemctl start mysqld.service
systemctl enable mysqld.service
```

## 4. nextcloud ã‚’é…ç½®ã™ã‚‹

`/var/www/`ä¸‹ã«é…ç½®ã™ã‚‹ã€‚

```shell
wget  https://download.nextcloud.com/server/releases/latest.tar.bz2
dnf install bzip2
tar jxvf latest.tar.bz2
mv nextcloud /var/www/.
```

## 5. ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã®ä½œæˆ

ã¨ã‚Šã‚ãˆãšãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§ä½¿ç”¨ã§ãã‚Œã° OK ãªã®ã§ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã§å‡Œãã€‚  
openssl ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```shell
dnf install openssl
```

ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã‚’ä½œæˆã€‚[å‚è€ƒ](https://qiita.com/snowmoon/items/9c96ee0fa6ed096e8940)ã€‚

```shell
mkdir /etc/ssl/nginx
openssl genrsa -out /etc/ssl/nginx/server.key 2048
openssl req -new -key /etc/ssl/nginx/server.key -out /etc/ssl/nginx/server.csr
openssl x509 -days 3650 -req -signkey /etc/ssl/nginx/server.key -in /etc/ssl/nginx/server.csr -out /etc/ssl/nginx/server.crt
```

## 6. nginx ã®è¨­å®šã‚’è¡Œã†

`vim /etc/nginx/conf.d/nextcloud.conf`ã§ã€Nextcloud ç”¨ã® nginx ã® conf ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼†è¿½è¨˜ã™ã‚‹ã€‚

[å…¬å¼ Doc](https://docs.nextcloud.com/server/latest/admin_manual/installation/nginx.html)ã‚’å‚è€ƒã«ã€åŸºæœ¬çš„ã«ã¯ã‚³ãƒ”ãƒšã§ OKã€‚  
å¤‰æ›´ç‚¹ã¨ã—ã¦ã€

- php-handler ã¯`/etc/nginx/conf.d/php-fpm.conf`ã«æ›¸ã„ã¦ã‚ã‚‹å†…å®¹ã«åˆã‚ã›ã‚‹
- HTTPS é€šä¿¡ã®ãŸã‚ã®è¨¼æ˜æ›¸ã¯[æ‰‹é † 5](../../../2023/07/04/01.html#5-ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã®ä½œæˆ) ã§ä½œæˆã—ãŸã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹

nginx ã® conf ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ã«å•é¡ŒãŒãªã„ã‹ã©ã†ã‹ã¯`nginx -t`ã§ç¢ºèªã§ãã‚‹ã€‚

```conf
upstream php-handler {
    # server 127.0.0.1:9000;
    server unix:/run/php-fpm/www.sock;
}

# Set the `immutable` cache control options only for assets with a cache busting `v` argument
map $arg_v $asset_immutable {
    "" "";
    default "immutable";
}


server {
    listen 80;
    listen [::]:80;
    server_name 192.168.10.xxx;

    # Prevent nginx HTTP Server Detection
    server_tokens off;

    # Enforce HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443      ssl http2;
    listen [::]:443 ssl http2;
    server_name 192.168.10.xxx;

    # Path to the root of your installation
    root /var/www/nextcloud;

    # Use Mozilla's guidelines for SSL/TLS settings
    # https://mozilla.github.io/server-side-tls/ssl-config-generator/
    ssl_certificate     /etc/ssl/nginx/server.crt;
    ssl_certificate_key /etc/ssl/nginx/server.key;
    # ssl_certificate     /etc/ssl/nginx/cloud.example.com.crt;
    # ssl_certificate_key /etc/ssl/nginx/cloud.example.com.key;

    # Prevent nginx HTTP Server Detection
    server_tokens off;

    # HSTS settings
    # WARNING: Only add the preload option once you read about
    # the consequences in https://hstspreload.org/. This option
    # will add the domain to a hardcoded list that is shipped
    # in all major browsers and getting removed from this list
    # could take several months.
    #add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload" always;

    # set max upload size and increase upload timeout:
    client_max_body_size 512M;
    client_body_timeout 300s;
    fastcgi_buffers 64 4K;

    # Enable gzip but do not remove ETag headers
    gzip on;
    gzip_vary on;
    gzip_comp_level 4;
    gzip_min_length 256;
    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;
    gzip_types application/atom+xml text/javascript application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;

    # Pagespeed is not supported by Nextcloud, so if your server is built
    # with the `ngx_pagespeed` module, uncomment this line to disable it.
    #pagespeed off;

    # The settings allows you to optimize the HTTP2 bandwitdth.
    # See https://blog.cloudflare.com/delivering-http-2-upload-speed-improvements/
    # for tunning hints
    client_body_buffer_size 512k;

    # HTTP response headers borrowed from Nextcloud `.htaccess`
    add_header Referrer-Policy                   "no-referrer"       always;
    add_header X-Content-Type-Options            "nosniff"           always;
    add_header X-Download-Options                "noopen"            always;
    add_header X-Frame-Options                   "SAMEORIGIN"        always;
    add_header X-Permitted-Cross-Domain-Policies "none"              always;
    add_header X-Robots-Tag                      "noindex, nofollow" always;
    add_header X-XSS-Protection                  "1; mode=block"     always;

    # Remove X-Powered-By, which is an information leak
    fastcgi_hide_header X-Powered-By;

    # Add .mjs as a file extension for javascript
    # Either include it in the default mime.types list
    # or include you can include that list explicitly and add the file extension
    # only for Nextcloud like below:
    include mime.types;
    types {
        js mjs;
    }

    # Specify how to handle directories -- specifying `/index.php$request_uri`
    # here as the fallback means that Nginx always exhibits the desired behaviour
    # when a client requests a path that corresponds to a directory that exists
    # on the server. In particular, if that directory contains an index.php file,
    # that file is correctly served; if it doesn't, then the request is passed to
    # the front-end controller. This consistent behaviour means that we don't need
    # to specify custom rules for certain paths (e.g. images and other assets,
    # `/updater`, `/ocm-provider`, `/ocs-provider`), and thus
    # `try_files $uri $uri/ /index.php$request_uri`
    # always provides the desired behaviour.
    index index.php index.html /index.php$request_uri;

    # Rule borrowed from `.htaccess` to handle Microsoft DAV clients
    location = / {
        if ( $http_user_agent ~ ^DavClnt ) {
            return 302 /remote.php/webdav/$is_args$args;
        }
    }

    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }

    # Make a regex exception for `/.well-known` so that clients can still
    # access it despite the existence of the regex rule
    # `location ~ /(\.|autotest|...)` which would otherwise handle requests
    # for `/.well-known`.
    location ^~ /.well-known {
        # The rules in this block are an adaptation of the rules
        # in `.htaccess` that concern `/.well-known`.

        location = /.well-known/carddav { return 301 /remote.php/dav/; }
        location = /.well-known/caldav  { return 301 /remote.php/dav/; }

        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }
        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }

        # Let Nextcloud's API for `/.well-known` URIs handle all other
        # requests by passing them to the front-end controller.
        return 301 /index.php$request_uri;
    }

    # Rules borrowed from `.htaccess` to hide certain paths from clients
    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)  { return 404; }
    location ~ ^/(?:\.|autotest|occ|issue|indie|db_|console)                { return 404; }

    # Ensure this block, which passes PHP files to the PHP process, is above the blocks
    # which handle static assets (as seen below). If this block is not declared first,
    # then Nginx will encounter an infinite rewriting loop when it prepends `/index.php`
    # to the URI, resulting in a HTTP 500 error response.
    location ~ \.php(?:$|/) {
        # Required for legacy support
        rewrite ^/(?!index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+|.+\/richdocumentscode\/proxy) /index.php$request_uri;

        fastcgi_split_path_info ^(.+?\.php)(/.*)$;
        set $path_info $fastcgi_path_info;

        try_files $fastcgi_script_name =404;

        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $path_info;
        fastcgi_param HTTPS on;

        fastcgi_param modHeadersAvailable true;         # Avoid sending the security headers twice
        fastcgi_param front_controller_active true;     # Enable pretty urls
        fastcgi_pass php-handler;

        fastcgi_intercept_errors on;
        fastcgi_request_buffering off;

        fastcgi_max_temp_file_size 0;
    }

    # Serve static files
    location ~ \.(?:css|js|mjs|svg|gif|png|jpg|ico|wasm|tflite|map)$ {
        try_files $uri /index.php$request_uri;
        add_header Cache-Control "public, max-age=15778463, $asset_immutable";
        access_log off;     # Optional: Don't log access to assets

        location ~ \.wasm$ {
            default_type application/wasm;
        }
    }

    location ~ \.woff2?$ {
        try_files $uri /index.php$request_uri;
        expires 7d;         # Cache-Control policy borrowed from `.htaccess`
        access_log off;     # Optional: Don't log access to assets
    }

    # Rule borrowed from `.htaccess`
    location /remote {
        return 301 /remote.php$request_uri;
    }

    location / {
        try_files $uri $uri/ /index.php$request_uri;
    }
}
```

## 7. php-fpm ã‚’ç·¨é›†ã™ã‚‹

`/etc/php-fpm.d/www.conf`ã‚’ç·¨é›†ã™ã‚‹ã€‚  
`env[PATH]`ã¯`echo $PATH`ã®å®Ÿè¡Œçµæœã«ã™ã‚‹ã€‚

```shell
[root@ap-al91 ~]# echo $PATH
/root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
```

```conf
; Pass environment variables like LD_LIBRARY_PATH. All $VARIABLEs are taken from
; the current environment.
; Default Value: clean env
env[HOSTNAME] = $HOSTNAME
env[PATH] = /root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
env[TMP] = /tmp
env[TMPDIR] = /tmp
env[TEMP] = /tmp
```

**â€» ä¸Šè¨˜é …ç›®ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Œ;ã€ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å¿˜ã‚Œãšã«å…ˆé ­ã®ã€Œ;ã€ã‚’å‰Šé™¤ã™ã‚‹ã€‚**

## 8. php.ini ã‚’ç·¨é›†ã™ã‚‹

`/etc/php.ini`ã‚’ç·¨é›†ã™ã‚‹ã€‚  
ã“ã® VM ã«å¯¾ã—ã¦ 8GB ã®ãƒ¡ãƒ¢ãƒªã‚’å‰²ã‚Šå½“ã¦ã¦ã‚ã‚‹ã®ã§ã€ãã®ç¯„å›²å†…ã§é©å½“ã«å‰²ã‚Šå½“ã¦ã‚‹ã€‚

```ini
memory_limit = 4G
post_max_size = 2G
upload_max_filesize = 2G
```

## 9. MySQL ã®è¨­å®šã‚’è¡Œã†

root ã§ãƒ­ã‚°ã‚¤ãƒ³ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ã‚‚å…¥åŠ›ã—ãªã„ã€‚

```shell
mysql -p -u root
```

Nextcloud ç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã™ã‚‹ã€‚

```shell
CREATE DATABASE nextcloud DEFAULT CHARACTER SET utf8mb4;
SHOW DATABASES;
CREATE USER 'nextcloud_admin'@'localhost' IDENTIFIED BY 'hogehoge';
GRANT ALL ON nextcloud.* TO 'nextcloud_admin'@'localhost';
SHOW GRANTS FOR 'nextcloud_admin'@'localhost';
exit;
```

## 10. ãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹

```shell
firewall-cmd --list-all
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --zone=public --add-service=https --permanent
firewall-cmd --reload
firewall-cmd --list-all
```

## 11. reboot

ã„ã‚ã„ã‚ã‚„ã£ãŸã®ã§ rebootã€‚

## 12. Nextcloud ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

Nextcloud ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã€‚

ã¾ãšã¯`/var/www/nextcloud`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰€æœ‰è€…ã‚’`apache`ã«ã™ã‚‹ã€‚

```shell
chown -R apache:apache /var/www/nextcloud
```

æ¬¡ã«`/var/www/nextcloud`ä¸‹ã®`config`ã¨`apps`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ›¸ãè¾¼ã¿æ¨©é™ã‚’è¿½åŠ ã™ã‚‹ã€‚

```shell
chmod g+w /var/www/nextcloud/config
chmod g+w /var/www/nextcloud/apps
chmod o+w /var/www/nextcloud/config
chmod o+w /var/www/nextcloud/apps
```

SELinux ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹ã«ã™ã‚‹ã€‚

```shell
setenforce 0
```

ã“ã“ã¾ã§å®Œäº†ã—ãŸã‚‰ã€`http://ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹`ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚  
ã‚ªãƒ¬ã‚ªãƒ¬è¨¼æ˜æ›¸ã‚’ä½¿ã£ã¦ã„ã‚‹ãŸã‚ã€FireFox ã§ã¯ä¸‹ã®ç”»åƒã®ã‚ˆã†ãªè­¦å‘ŠãŒå‡ºã‚‹ãŒç„¡è¦–ã—ã¦é€²ã‚€ã€‚

![ç”»åƒ1](/assets/img/blog/2023-07-04-01.webp)

Nextcloud ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€DB ã« MySQL ã‚’ä½¿ã†ã‚ˆã†ã«è¨­å®šã™ã‚‹ã€‚

![ç”»åƒ2](/assets/img/blog/2023-07-04-02.webp)

![ç”»åƒ3](/assets/img/blog/2023-07-04-03.webp)

è¨­å®šãŒä¸€é€šã‚Šå®Œäº†ã™ã‚‹ã¨ä»¥ä¸‹ã®ç”»é¢ã«é·ç§»ã™ã‚‹ã€‚  
ã€Œæ¨å¥¨ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€ã™ã‚‹ã€‚

![ç”»åƒ4](/assets/img/blog/2023-07-04-04.webp)

å®Œäº†ã™ã‚‹ã¨ä»¥ä¸‹ã®ç”»é¢ã«é·ç§»ã™ã‚‹ã€‚

![ç”»åƒ5](/assets/img/blog/2023-07-04-05.webp)

ç”»åƒãƒ»å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–²è¦§ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

## 13. SELinux ã®è¨­å®šã‚’è¡Œã†

[å…¬å¼ Doc](https://docs.nextcloud.com/server/latest/admin_manual/installation/selinux_configuration.html)ã‚’å‚è€ƒã«ã€å¿…è¦ãã†ãªã‚‚ã®ã‚’è¨­å®šã—ã¦ã„ãã€‚

```shell
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/data(/.*)?'
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/config(/.*)?'
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/apps(/.*)?'
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/.htaccess'
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/.user.ini'
semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/nextcloud/3rdparty/aws/aws-sdk-php/src/data/logs(/.*)?'

restorecon -Rv '/var/www/nextcloud/'

setsebool -P  httpd_unified  off
```

çµ‚ã‚ã£ãŸã‚‰ rebootã€‚

Nextcloud ã‚’é–‹ãã€æ‰‹é †å®Ÿè¡Œå‰ã¨åŒã˜ã‚ˆã†ã«ä½¿ãˆã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

## 14. ãƒ‡ã‚£ã‚¹ã‚¯ãƒã‚¦ãƒ³ãƒˆ

[å‰å›](../../../2023/04/16/01.html#8-raid-ãƒ‡ã‚£ã‚¹ã‚¯ã‚’ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼ã—ã¦ã‚²ã‚¹ãƒˆå´ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹) VM ã«ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼ã—ãŸ RAID ãƒ‡ã‚£ã‚¹ã‚¯ã‚’`/var/www/nextcloud/data`ã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ã€‚

å¿µã®ãŸã‚ã«ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã€‚

```shell
systemctl stop nginx.service
systemctl stop php-fpm.service
systemctl stop mysqld.service
```

`/var/www/nextcloud/data`ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ RAID ãƒ‡ã‚£ã‚¹ã‚¯ã«ç§»ã™ã€‚

```shell
mount /dev/vdb /mnt
rsync -avh --progress /var/www/nextcloud/data/* /mnt/.
```

`/var/www/nextcloud/data`ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦å…ˆç¨‹ã®ãƒ‡ã‚£ã‚¹ã‚¯ã‚’ãƒã‚¦ãƒ³ãƒˆã€‚

```shell
rm -rf /var/www/nextcloud/data/*
mount /dev/vdb /var/www/nextcloud/data
```

å¿˜ã‚Œãšã«`/etx/fstab`ã¸ç™»éŒ²ã‚’è¡Œã†ã€‚

```txt
...
UUID=blkidã‚³ãƒãƒ³ãƒ‰ã§èª¿ã¹ãŸUUID /var/www/nextcloud/data xfs defaults 1 2
...
```

çµ‚ã‚ã£ãŸã‚‰ rebootã€‚

Nextcloud ã‚’é–‹ãã€æ‰‹é †å®Ÿè¡Œå‰ã¨åŒã˜ã‚ˆã†ã«ä½¿ãˆã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

## 15. å¾Œå§‹æœ«

### MySQL ã® root ãƒ¦ãƒ¼ã‚¶ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹

åˆæœŸè¨­å®šã§ã¯ root ãƒ¦ãƒ¼ã‚¶ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã®ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ä¿è­·ã™ã‚‹ã€‚

```shell
ALTER USER 'root'@'localhost' identified BY 'hogehoge';
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—è­¦å‘Šã‚’è§£æ±ºã™ã‚‹

ã¨ã‚Šã‚ãˆãšã“ã“ã¾ã§ä½œæ¥­ã‚’è¡Œã£ãŸçŠ¶æ…‹ã§ Nextcloud ã«ç®¡ç†è€…ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã€ç®¡ç†è€…è¨­å®šã‚’é–‹ãã€‚  
ç®¡ç†è€…è¨­å®šã§ã¯ã€ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—è­¦å‘Šã€ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  
ç¾æ™‚ç‚¹ã§è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹è­¦å‘Šã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

![ç”»åƒ6](/assets/img/blog/2023-07-04-06.webp)

ã¨ã‚Šã‚ãˆãšé»„è‰²æ–‡å­—ã§æ›¸ã‹ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã‚’ã‚µã‚¯ãƒƒã¨ç›´ã™ã€‚

#### ã“ã®ã‚µãƒ¼ãƒãƒ¼ã«ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒã‚ã‚Šã¾ã›ã‚“ã€‚

selinux ã§è¨±å¯ã‚’ä¸ãˆã‚‹ã ã‘ã€‚  
[å‚è€ƒ](https://help.nextcloud.com/t/this-server-has-no-working-internet-connection-it-does-really/67524)ã€‚

```shell
setsebool -P httpd_can_network_connect 1
```

#### Strict-Transport-Security "HTTP ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç§’æ•°ãŒå°‘ãªãã¨ã‚‚"15552000" ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

è¨­å®šã—ã‚ˆã†ã€‚  
å…·ä½“çš„ã«ã¯[æ‰‹é † 6](../../../2023/07/04/01.html#6-nginx-ã®è¨­å®šã‚’è¡Œã†) ã§è¨­å®šã—ãŸ nginx ã® conf ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã™ã ã‘ã€‚  
[å‚è€ƒ](https://qiita.com/fluo10/items/1665e3500aace239c257#nginx-%E3%81%AE%E8%A8%AD%E5%AE%9A)ã€‚

```conf
server {
    listen 443      ssl http2;
    ...
    add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload" always;
    ...
}
```

å®Œäº†ã—ãŸã‚‰ã€nginx ã‚’å†èµ·å‹•ã€‚

â€» [Strict-Transport-security ã¨ã¯ï¼Ÿ](https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Strict-Transport-Security)

#### ãã®ä»–

PHP ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç³»ã¯è¿½åŠ ã—ã¦ php-fpm ã‚’å†èµ·å‹•ã™ã‚Œã° OKã€‚

```shell
dnf install php-sodium
dnf install php-bcmath
dnf install php-gmp
dnf install php-opcache

systemctl restart php-fpm.service
```

é•·ããªã‚Šãã†ãªã®ã§ä»–ã®è­¦å‘Šã§å¯¾å¿œãŒå¿…è¦ãªã‚‚ã®ã¯ã¾ãŸä»Šåº¦ã‚„ã‚‹ã€‚~~ï¼ˆã‚ã‚“ã©ãã•ã„ ğŸ˜‡ï¼‰~~

## ãƒãƒã£ãŸç‚¹ï¼†å¯¾ç­–

### ã€Œãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª/var/www/nextcloud/data ã«ä½œæˆã€æ›¸ãè¾¼ã¿ãŒã§ãã¾ã›ã‚“ã€ã€Œç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€

#### ç—‡çŠ¶

[æ‰‹é † 12](../../../2023/07/04/01.html#12-nextcloud-ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—) ä¸­ã€å½“åˆã¯`apache:apache`ã§ã¯ãªã`nginx:nginx`ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é€²ã‚ã¦ã„ãŸã¨ã“ã‚ã€ä¸‹ç”»åƒã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸã€‚

![ç”»åƒ7](/assets/img/blog/2023-07-04-07.webp)

#### å¯¾ç­–

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰€æœ‰è€…ã‚’`nginx:nginx`ã§ã¯ãªã`apache:apache`ã«è¨­å®šã™ã‚‹ã¨.ocdata ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚€ã“ã¨ãŒã§ããŸã€‚  
`apache:apache`ã¯ RedHat ç³»ã® OS ã§ Web ã‚µãƒ¼ãƒãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é€šå¸¸ã®æ“ä½œã«ä½¿ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ï¼Ÿã¿ãŸã„ã€‚[å‚è€ƒ](https://qiita.com/micron/items/56cdc72112f2f9b09fa2)ã€‚  
ãŸã ã€æ…£ç¿’çš„ã«ã¯`nginx:nginx`ã§è¨­å®šã—ãŸã„ã¨ã“ã‚ã€‚ã‚ˆã‚Šè‰¯ã„å¯¾å‡¦æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹äººãŒã„ãŸã‚‰æ•™ãˆã¦ ğŸ™

### ãƒ­ã‚°ã‚¤ãƒ³ç„¡é™ãƒ«ãƒ¼ãƒ—å•é¡Œ

#### ç—‡çŠ¶

æ­£ã—ã„ãƒ¦ãƒ¼ã‚¶ ID ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ã„ã‚‹ã®ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã€‚  
ç‰¹ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ã‘ã§ã‚‚ãªãã€ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«æˆ»ã•ã‚Œã¦ã—ã¾ã†ã€‚

#### å¯¾ç­–

[ã“ã¡ã‚‰ã®è¨˜äº‹](https://diary.d-yoshi.com/%E3%80%90nextcloud%E3%80%91%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%83%AB%E3%83%BC%E3%83%97-3-%E3%82%A2%E3%83%83%E3%82%B5%E3%83%AA%E8%A7%A3%E6%B1%BA/)ã‚’å‚è€ƒã« session ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸‹ã®æ‰€æœ‰è€…ã‚’`apache:apache`ã«å¤‰æ›´ã™ã‚‹ã¨ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚  
Almaliux9.1 ã§ã® session ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ã¯`/var/lib/php/session`ã ã£ãŸã€‚

è€ƒå¯Ÿ: ä»Šå›ã¯å€‹äººç”¨ã ã‹ã‚‰è¦ã‚‰ãªã„ã‹ãªã¨æ€ã£ã¦å°å…¥ã—ã¦ãªã„ã‘ã©ã€ redis ã¨é€£æºã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚Œã°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãã£ã¡ã§ç®¡ç†ã—ã¦ãã‚Œã‚‹ã¯ãšãªã®ã§è‡ªãšã¨è§£æ±ºã™ã‚‹ï¼Ÿ

### Office ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–²è¦§ã§ããªã„

#### ç—‡çŠ¶

Office ãƒ•ã‚¡ã‚¤ãƒ«ãŒ Nextcloudï¼ˆWebï¼‰ä¸Šã§é–²è¦§ã§ããªã„ã€‚  
Nextcloud Office ã®è¨­å®šç”»é¢ã‚’è¦‹ã‚‹ã¨ã€ã€ŒCollabora Online ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã‚’ç¢ºç«‹ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚Web ã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šãŒä¸è¶³ã—ã¦ã„ã‚‹ã“ã¨ãŒåŸå› ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’ã”è¦§ãã ã•ã„ã€‚[Nginx ã§ Collabora Online ã¸ã‚·ãƒ³ã‚°ãƒ«ã‚¯ãƒªãƒƒã‚¯æ¥ç¶š](https://www.collaboraoffice.com/online/connecting-collabora-online-built-in-code-server-with-nginx/)ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã€‚

#### å¯¾ç­–

å€‹äººçš„ã«ã¯å†™çœŸãƒ»å‹•ç”»ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ä½¿ãˆã‚Œã°ãã‚Œã§ OK ãªã®ã§ã€ Office ãƒ•ã‚¡ã‚¤ãƒ«ã®é–²è¦§ãŒ Web ä¸Šã§ã§ããªãã¦ã‚‚ã¾ã‚ã„ã„ã‹ã¨ã„ã†ã“ã¨ã§æ”¾ç½®ã€‚  
è§£æ±ºã—ãŸã‚‰æ›¸ãã€‚

è€ƒå¯Ÿ: nginx ã§æ§‹ç¯‰ã—ãŸã¨ãå›ºæœ‰ã®å•é¡Œã®ã‚ˆã†ãªã®ã§ã€ç´ ç›´ã« Apache HTTP Server ã‚’ä½¿ãˆã°ã“ã®ã‚ˆã†ãªå•é¡Œã¯ç™ºç”Ÿã—ãªã„ã¨æ€ã‚ã‚Œã‚‹ã€‚

## ã“ã“ã¾ã§ã®æ‰‹é †ã‚’å®Ÿæ–½å¾Œã€iPhone ã§æ’®å½±ã—ãŸç”»åƒãƒ»å‹•ç”»ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹æ§˜å­

![ç”»åƒ8](/assets/img/blog/2023-07-04-08.webp)

## æ¬¡å›

å°‘ã€…é•·ããªã£ã¦ã—ã¾ã£ãŸï¼†ã¾ã è§£æ±ºã™ã¹ãå•é¡Œã¯æ®‹ã£ã¦ã„ã‚‹ã‘ã©ã€ã¨ã‚Šã‚ãˆãšã“ã‚Œã§ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§ Nextcloud ãŒåˆ©ç”¨ã§ãã‚‹çŠ¶æ…‹ã«ãªã£ãŸã€‚  
æ¬¡å›ã¯ Joplin ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
